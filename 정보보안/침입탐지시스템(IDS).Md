# 침입탐지시스템(IDS)

1. 침입탐지시스템

- 경비 체계 비교
  - 침입차단시스템 : 처음부터 들어오지 못하게 하는 것
  - 침입탐지시스템 : 들어와서 활동을 하되, CCTV 역할을 하는 것

2. 개념 및 특징
- 침입탐지시스템(IDS Intrusion Detection System)
  - 외부 침입자의 IT자원에 대한 불법적인 접근 및 보안정책을 위반하는 행위, 즉 침입을 탐지하는 시스템
  - 침입차단시스템과의 차이는 정상적인 접속이 이루어진 상황에서 판단

3. 주요 기능
- 경보기능 : 이메일, SNS, SNMP(Simple Network Management Protocol) 발송 등
- 실시간 탐지 : 사용자 행위, 트래픽 특성 등을 파악하여 실시간 침입 여부 탐지
- 세션차단기능 : 공격자의 TCP세션에 대해 FIN, RST패킷을 전송하여 침입 패킷 강제종료.  
ICMP의 "POST UNREACHABLE" 메시지를 전달하여 시스템 격리

- 정보수집 및 분석 모듈
  - 호스트, 네트워크로부터 수집하여 시스템 및 패턴 DB설정에 따라 정보 분석

- 분석결과를 저장하는 로그 저장소
- 패턴 생성 모듈
  - 침입분석자료를 통해 패턴 생성
  - 패턴생성모듈에 의해 생성된 패턴의 저장, 관리
- 이벤트 보고 모듈
  - 로그 저장소 분석 결과를 관리자에게 발송

4. 침입탐지시스템 분류 
- 데이터 소스 : 시스템데이터 네트워크 패킷
- 탐지방법 : 오용탐지, 이상행위탐지
- 감사자료분석 : 독립분석, 협력분석
- 데이터 소스 제공 : 독립분석, 협력분석
- 반응성 : 능동형, 수동형

5. 데이터 소스에 따른 유형
- 호스트기반(HIDS)
  - 감사자료(로그파일), 시스템 콜 정보 활용
  - 다양한 감사자료 활용 시 정확한 탐지 기능
  - 서버 및 PC에 직접 에이전트를 설치하고 정보를 수집하여 서버 부하 가능성

|운영체제와의 연관성|종속적|
|:                 :|:    :|
|침입탐지 시기       |비교적 늦음|
|침입흔적 삭제       |가능       |
|서비스거부 공격 탐지 |제한적     |
|암호화된 침입        |탐지가능   |
|공격루트 탐지 범위   |시스템, 네트워크|

사건(이벤트) 수집 >> 데이터 포맷 구성 >> 침입 탐지

- 네트워크 기반(NIDS)
  - 독립적으로 네트워크에서 설치, 운영되어 각 서버의 성능 저하 없음
  - 네트워크 트래픽이 암호화 되어 있을 경우 탐지 불가
  - 네트워크 트래픽 증가 시 성능 저하
 
|운영체제와의 연관성|종속적|
|:                 :|:    :|
|침입탐지 시기       |상대적으로 빠름|
|침입흔적 삭제       |불가능       |
|서비스거부 공격 탐지 |가능     |
|암호화된 침입        |탐지불가능   |
|공격루트 탐지 범위   |네트워크|

패킷 수집 >> 패킷 축약(필터링 + 축약) >> 침입 탐지

6. 탐지 방법에 따른 유형
- 오용(Misuse Detection) 탐지
  - 알려진 비정상 시그너처 패턴을 기반으로 침입 탐지
  - 패턴과 축약 가공 데이터 비교

침입 감사 자료 >> 시스템 프로파일 >> 침입 상태

  - 장점 : 오탐 가능성 적음, 관리 및 보고 용이, 설치 즉시 사용가능
  - 단점 : 알려지지 않은 패턴 수집 어려움, 오탐을 줄이기 위한 세밀한 패턴 필요, 지속적인 해킹 기술 습득 필요
  - 주요 기법 : 서명분석(시그너처 분석), 전문가 시스템, 상태 전이 분석

- 이상행위(Anomaly Behavior Detection) 탐지
  - 정상행위 정보를 기반으로 침입탐지
  - 사용자의 행동패턴을 분석하고 정상 패턴과 비교 분석

침입 감사 자료 >> 시스템 프로파일 >> 침입 위험 노출 상태

  - 장점 : 새로운 공격패턴 탐지 가능, 학습능력 포함
  - 단점 :  오탐 가능성 높음, 장기간의 학습 필요, 실제 학습환경 구축의 어려움
  - 주요기법 : 통계적 방법, 예측 가능 패턴 생성, 비정상 행위 처리, 신경망 분석

2. 침입탐지 모델
- 오용탐지모델
  - 전문가 시스템 : 감사기록 자료를 이전에 설정된 규칙의 집합과 비교

- 키 스트로크 모니터링
  - 키 입력을 이전에 설정된 규칙의 집합과 비교
  - 오탐을 줄이기 위해 시맨틱 분석 필요

- 상태 전이 분석
  - 공격에 대한 상태 전이 다이어그램을 확보
  - 데이터의 조건이 "true"일 경우 상태 전이

- 이상행위 탐지 모델
  - 예측 패턴 생성 : 기 발생된 사건에서 이벤트에 대한 확률 도출  
고 수준 룰은 남겨 놓고, 저 수준 룰은 제거

  - 신경망 회로 : 신경망 러닝 시스템을 통해 프로파일 생성  
러닝 데이터에 따라 False Detection 발생

3. 침입방지시스템
- 개념 및 특징
  - 침입방지시스템(IPS Intrusion Protection System) : 외부에서 들어오는 유해 트래픽 차단 및 내부 행위자의 불법 행위 탐지 등  
실시간 방어가 가능한 보안 솔루션
    - 트래픽의 정확한 분석 능력
      - 3계층 ~ 7계층까지 상태유지 검사
      - 데이터 캡처, 컨텍스트 기반 다중 트리거, 다중 패턴 시그너츠 매칭
    - 광범위한 침입 및 안정적인 대응 능력
      - 인라인 능력 : 공격을 실시간 탐지하기 위하여 장비를 트래픽 경로에 위치
      - 고성능 제공 : 패킷 처리 시간의 최소화
      - 다양한 공격 대응 능력 : 안티 바이러스, 스캐닝 공격 탐지 및 대응
      - 신뢰도 높은 센서 가동시간 및 고사양의 프로세서 필요

- 구성 및 구성요소 
  - IPS의 설치는 보호하고자 하는 네트워크의 전단에 배치 
  - IDS는 TAP, 또는 미러링하며 IPS는 IN-LINE 설치
  - 관리 모듈 : 시그너처 및 웜/바이러스 패턴관리, 포랜직(Forensic) 기능
  - 처리 모듈 : 캡처 엔진, 탐지 엔진, 대응 엔진으로 구성

- 데이터 소스에 따른 유형
  - 호스트 기반(HIPS) 
    - 각 호스트에 설치된 IPS 에이전트가 시스템의 해킹 시도 이상징후 탐지/차단
    - 각 호스트 별 에이전트를 설치 관리의 어려움
  - 특징 : 서버의 커널 조작 등 침입 방지
  - 목적 : 시스템 불법 침입 및 바이러스 해킹 대응
  - 장점 : 커널 상 에서 불법 응용 방지
  - 단점 : 정상 응용 프로그램 방해 가능성

  - 네트워크 기반(NIPS)
    - 네트워크의 물리적 혹은 논리적 경계지점에 인라인(IN-LINE)방식으로 설치
    - 네트워크 접속과 트래픽 분석을 통해 유해 트래픽 차단 
  - 특징 : 웹 DDoS, 오버플로우 등
  - 목적 : 네트워크의 과도한 트래픽 방지
  - 장점 : 하드웨어 기반의 빠른 대응
  - 단점 : 네트워크상의 단일 장애점으로 인한 가용성 문제   
