# 병행 프로세스와 상호배제(1)

1. 병행 프로세스 ** 프로세스 여러개가 동시에 실행 **
- 독립적으로 작업을 수행, 다른 프로세스와 협력하여 특정 기능 수행
- 프로세스 간 교신이 필요하다.

** 비동기적 병행 프로세스 **
- 프로세스 간 교신 시 동기화되어야하는 프로세스

** 상호 작용 **
- 제한된 자원을 공유하기 위함이며, 상호 작용하는 프로세스는 순서에 맞게 실행되도록 동기화되어야한다.

** 병행성 **
- 다수의 프로세서를 이용하여 작업을 수행하며, 다중 프로세싱 시스템, 분산 처리 환경, 다중 프로그래밍 운영체제에서 매우 중요하다.
- 시스템의 신뢰도 향상과 처리 속도 개선을 통한 처리 능력 증대에 매우 중요하다.
- 다중 프로세싱 프로그램
  - 각 프로세서가 갖는 오버헤드를 감소시키면서 프로세서의 유효성을 증대시킨다.
  - 여러개의 명령어를 세분화하여 동시에 처리하기위해 프로세서들을 연결 상호작용을 제어한다.

** 다중 프로세싱 시스템의 성공적인 구현을 위한 해결 문제 **
- 공유 자원을 상호 배타적으로 사용해야한다.
- 병행 프로세서들 사이는 협력, 동기화되어야한다,
- 두 프로세스 사이에 데이터 교환을 위한 통신이 이루어져야한다.
- 프로세서는 결정성(Determinacy)를 확보해야한다.
- 교착 상태를 해결하고 병행프로세서들의 병렬처리 능력 극대화
- 실행 검증 문제 해결 
- 병행 프로세스 수행과정에서 발생하는 상호배제를 보장해야한다.

** 다중 프로세싱 시스템은 프로세스 동기화 알고리즘이 필요하다. **
- 프로세서들이 모든 입출력 장치와 메모리를 참조 가능
- 동시에 동일한 자원에 접근할 경우 충돌이 발생하므로 이를 해결한다.

** 선행 제약 **
- 프로세스가 순서대로 다른 상태로 옮겨간다.
- 프로세스 p1 ~ p2 ~ .. p~n~ 가 있을 때, 선행 순서는 p~i~ < p~j~로 표시, 상태는 p~i~ 에서 p~j~로 옮겨간다.
- 따라서 p~i~ < p~j~ , p~j~ < p~k~
- 두 프로세스 간에 선행 관계가 없으면 이들은 독립적이라 병행 실행이 가능하다.

** 선행 그래프 **
- 제약을 규칙적(논리적)으로 표현한 것
- 각 문장에 대응되는 노드가 비순환 그래프를 이용한다.

** 산술 연산 수행 알고리즘 **
- 병행수행을 하기 위해 프로세서 안의 기능 단위를 여러개 두거나 프로세서를 여러개 사용해야한다.
- 프로세서를 여러개 사용 시 여러문장이 동시에 수행되어 총 수행시간을 줄일 수 있다.

** 프로그램의 여러문장의 선행 관계 명시를 위해 두 가지 언어구조 제시 **
** FORK, JOIN 구조 **
- 선행 그래프는 연산 부분의 선행 제약을 정의하는데 유용하나, 2차원이므로 프로그래밍 언어에서 사용하기에 어렵다.
- 콘웨이 (Conway 1963), 데니스 (Denis 1966), 호른 (Van Horn 1966) 소개
- 병행을 최초로 언어적 표현으로 명시 

** COUNT를 매개변수로 가지는 JOIN 명령 **
- Count는 0이 아닌 정수 값, quit는 count의 계산 수행을 종료시키는 명령
  - join 연산이 2개라면 매개변수 count의 초기값은 2

** 임의의 순서로 순차 수행되는 것과 동일한 알고리즘 **
- 두 개의 join 문장의 병행 수행은 두 문장을 임의의 순서로 순차 수행하는 것과 동일하다.

** 산술식에 대한 선행 그래프와 fork-join 구조 **
- 두 개의 read 문장을 병행 수행하기위한 fork-join 명령

** 병행 문장 **
- 프로세스 하나가 여러 가닥의 병령 프로세스로 펴졌다가 다시 한 가닥으로 뭉쳐지는 것을 나타내는 고급 언어 구조 
- 예) 다익스트라(Dijkstra, 1965) 'parbegin/parend'
- 각 si는 단일 문장 (명령어), parbegin, parend 사이의 모든 문장은 병행 수행 가능
- 보다 효과적인 병행 문장은 s0, sn+1문장을 추가하여 아래와 같이 정의 가능

2. 상호배제, 동기화
** 상호배제 **
- 특정 공유 자원을 한 순간에 한 개의 프로세스만 사용할 수 있을 때, 프로세스 하나가 공유 데이터에 접근하는동안 다른 프로세스가 해당 데이터를 접근할 수 없게 하는 것

** 프로세스 간 동기화 **
- 공유자원을 동시에 사용하지 못하게 실행을 제어하는 기법
- 순차적으로 재사용 가능한 자원을 공유하기위해 상호작용하는 프로세스 사이에서 나타난다.

** 프로세스는 아래 세 가지 형태로 상호작용한다. **
- 프로세스들이 서로 인식하지 못하는 경쟁관계유지
- 프로세스들은 입출력 버스를 비롯한 개체를 공유하는 단계에서 간접적으로 서로의 관계를 인식한다.
- 프로세스들은 서로를 인식하고 프로세스끼리 통신할 수 있는 기본 함수를 가진다.

** 생산자 / 소비자 판독자 / 기록자 문제 **
- 여러프로세스가 공통 작업 수행을 위해 서로 협동하고, 병행 처리되는 대표적인 예)
- 상호배제와 동기화가 필요하며 세마포어를 이용해 구현
- 운영체제에서 비동기적으로 수행하는 모델로 생산자 프로세스는 소비자 프로세스가 소비하는 정보를 생산한다.

** 생산자와 소비자 프로세스들을 병행 실행하기위해 공유 버퍼가 필요하다. **
- 생산자의 데이터 생산속도, 데이터 소비 속도는 서로 독립적이므로 버퍼가 필요하다.
- 생산자가 이미 채워진 버퍼에 더 채우거나, 소비자가 빈 버퍼에서 데이터를 꺼낼 때 문제 발생
- 속도가 다른 생산자와 소비자가 데이터를 일시 저장할 수 있는 버퍼 사용 시 버퍼는 여러가지 상태가 필요

** 프로세스 간 통신의 예 **
- 생산자/소비자 관계에서 한 프로세스가 정보를 생산하면 다른 프로세스는 그 정보를 소비한다.
- 버퍼가 비었거나 꽉 차 있을 때 버퍼에 접근하는 것을 막기 위해 생산자와 소비자가 동기화 되어있어야한다.

** 무한 버퍼 생산자 / 소비자 문제 **
- 버퍼의 크기에 제한을 두지 않으며 항상 버퍼에 빈자리가 존재한다.

** 유한 버퍼 생산자 / 소비자 문제 **
- 크기가 고정된 버퍼를 사용, 버퍼가 비었을 시 소비자가 대기, 버퍼가 가득차면 생산자가 대기한다.
- 공유 버퍼의 저장소를 두 개의 논리적 포인터 in, out을 사용한 순환배열로 해결 가능하다.


```
forL : 프로그램에서 두 개의 병행 수행을 만듦
	단일 연산을 두 개의 독립적인 연산으로 분할
- 레이블이 L인 문장에서 수행을 시작.
- fork 명령 바로 다음 문장에서 시작.

join : 여러개의 병행 연산을 하나로 결합하는 방법을 제공하며, 단윈적으로 수행해야하낟.
	합칠 연산의 수를 명시하는 매개변수를 가진다.
- 연산들이 서로 다른 속도로 진행되므로 둘 중 하나가 join을 먼저 수행하게된다.
- join 연산 수행 후 다른 연산 수행
- 세 개의 연산을 합칠 경우 두 개의 연산이 끝나고 join 연산을 수행한 다음 이들의 결과와 나머지 연산을 join
```


